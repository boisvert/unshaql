select ?sensor, ?day, avg(?observationValue), max(?observationValue), min(?observationValue)
where {
  graph ?g {
    ?s <uri://opensheffield.org/properties#sensor> ?sensor .
    ?s a <http://purl.oclc.org/NET/ssnx/ssn#ObservationValue> .
    ?s <http://purl.oclc.org/NET/ssnx/ssn#endTime> ?observationTime.
    ?s <http://purl.oclc.org/NET/ssnx/ssn#hasValue> ?observationValue .
    ?sensor <http://purl.oclc.org/NET/ssnx/ssn#MeasurementProperty> <http://dbpedia.org/resource/NO2>     .
    BIND (bif:subseq( str( ?observationTime ),0,11) AS ?day) .
    FILTER ( xsd:date(?observationTime) > xsd:date("2014-01-01") && xsd:date(?observationTime) <=    xsd:date("2014-11-13") )  
  }
}
GROUP BY ?sensor ?day
ORDER BY ?day ?sensor
