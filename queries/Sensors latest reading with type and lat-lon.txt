select ?sensor, ?measures, ?lat, ?long, ?timestamp, ?observationValue
where {
    ?observation <http://purl.oclc.org/NET/ssnx/ssn#hasValue> ?observationValue .
    ?observation <http://purl.oclc.org/NET/ssnx/ssn#endTime> ?timestamp .
    ?observation <uri://opensheffield.org/properties#sensor> ?sensor .
    ?sensor <http://purl.oclc.org/NET/ssnx/ssn#MeasurementProperty> ?measures .
    ?sensor <http://www.w3.org/2003/01/geo/wgs84_pos#long> ?long .
    ?sensor <http://www.w3.org/2003/01/geo/wgs84_pos#lat> ?lat .

    {
        select (max(?r) AS ?observation)
        where {
            ?r a <http://purl.oclc.org/NET/ssnx/ssn#ObservationValue> .
            ?r <uri://opensheffield.org/properties#sensor> ?sensor .
        }
        GROUP BY ?sensor
    }
}
